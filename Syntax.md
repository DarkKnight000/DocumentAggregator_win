# Версия 1

## Доступные идентификаторы

Имена, раскрывающиеся в значения этих полей.
Определяются интеракторами верхнего уровня.
Например, обработчик заявки подготавливает поля для самой заявки.
В этом случае, в отличие от предыдущей версии -
интерактор парсера только занимается обработкой формата вставки
и перекладывает часть своих задач на внешний объект,
обрабатывающий, к примеру, формат ролей доступа.

Идентификаторы представлляют собой простые поля или контейнеры с перечислениями.
Внутренняя вложенность неограничена, а циклическая - исключена.

### Доступ к простому полю

Выражается простой строкой, его именем.

Пример:
`year`,
`Year`.

### Доступ к контейнеру

Выражается в точности как к простому полю, однако сам по себе применяется только для описания таблицы.

### Доступ к содержимому контейнеров

У контейнера есть содержимое - некоторое количество объектов.
Эти объекты содержат такие же идентификаторы, как и внешний уровень.
Такая структура допускает глубокую иерархию данных.

Элементы могут находиться по порядку, а могут составлять словарь с численным ключом.

#### В таблице

Контейнер легко развернуть в таблицу, используя доступ к контейнеру.
Внутри таблицы обращение уже пойдёт к полям такого объекта (смена контекста).

Например, если таблица содержит перечисление сотрудников,
элемент управления для целой строки помечается идентификатором контейнера:
`employee`.

Внутри этой строки уже будут использоваться поля объекта сотрудника, например:
`#` (Служебное поле порядкового номера (или числового идентификатора) элемента, начиная с единицы),
`name`,
`mobile_phone`.

#### Вне таблицы

Вне таблицы используется специальный синтаксис сначала для доступа к отдельным элементам контейнера,
а затем и для доступа к полям содержимых объектов.

Пример доступа к элементам:
`employee[0]`,
`role[23]`.

Пример доступа к полям объекта:
`role[135].name`,
`claim[11352].id`.

## Этап разбора

Этап разбора никак не отличается от предыдущей версии.

## Этап наполнения

Этапом наполнения руководят парсер и источник полей документа.

### Парсер

#### Логическое поле

- Допускает неограниченное количество ведущих символов "!", инвертирующих значение поля.
- Допускает поля заявки или пользовательские поля со значенинями "True" или "False" (независимо от регистра).

#### Текстовое поле

Работает в точнности как текстовое поле на этапе выполнения предыдущей версии синтаксиса.

### Поля заявки



### Поля инвентаризации



# Версия 0

Не используется в настоящее время и заточена под задачу о заявках.

## Доступные идентификаторы

То есть имена, раскрывающиеся в значения этих полей.

### Идентификатор поля заявки

Целое число.
Пример:
`1018`.

### Идентификатор дополнительного поля

Строка любого регистра.
Пример:
`year`.

### Идентификатор роли доступа

Строка, начинающаяся на звёздочку (`*`) и оканчивающаяся на символ типа доступа:
- Запрошен (allowed) = `a`
- Изменён (changed) = `c`
- Отозван (denied) = `d`
Между этими символами прописывается числовой идентификатор роли, в противном случае расчёт идёт по всему ресурсу.
Примеры:
`*a`,
`*c`,
`*1352a`,
`*846d`.

## Этап разбора

Из документа выбираются элементы управления содержимым верхнего уровня (без вложенных в "таблицы").
Затем рекурсивно определяются все поля документа, включая содержимое таблиц.
Для таблиц имеется особый вид "вставки", не подразумевающий встраивание иных таблиц.
Следовательно максимальный уровень "рекурсии" - единица.

У элемента управления содержимым определяется его тип: для текстового поля - текстовая вставка, для флажка - логическая,
а для элемента без типа (по умолчанию - форматированный текст) - вставка формы (таблицы).

## Этап наполнения

### Логическое поле

- Допускает неограниченное количество ведущих символов "!", инвертирующих значение поля.
- Допускает поля заявки или пользовательские поля со значенинями "True" или "False" (независимо от регистра).
- Допускает значение установки ролей доступа к ресурсу.

Простой пример:
`20` (При условии, что поле запроса содержит значение `true` или `false`).

Сложный пример:
`!*230d`

### Текстовое поле

- Допускает неограниченное перечисление идентификаторов полей заявки
- Допускает любое значение

При перечислении полей доступны разделители `,` и `/`, замешаемые в `, ` и ` / ` соответственно.
Сложный пример:
`name,201/year,address`

### Форматированное поле

- Имеет одно только использование для заполнения заявки с зарегестрированным идентификатором КРР-04 ИС ОДФР
- Имеет пять "столбцов": порядковый номер ресурса (строка), его имя (строка), первая-третья роли (логические поля)
